{"version":3,"file":"main.js","mappings":";;;;;;;;;;;;;;;;;AAAgF;AAChB;AACtB;AAE1C,MAAMG,UAAU,CAAC;EACbC,WAAWA,CAACC,MAAM,GAAG,CAAC,CAAC,EAAE;IACrB,IAAI,CAACA,MAAM,GAAGA,MAAM;EACxB;EAEA,CAACC,YAAY,GAAG,KAAK;EACrBC,UAAU,GAAG,EAAE;EACfC,YAAY,GAAG,IAAIC,GAAG,CAAC,CAAC;EAExBC,IAAIA,CAAA,EAAG;IACH,IAAI,IAAI,CAAC,CAACJ,YAAY,EAAE;IACxB,IAAI,CAAC,CAACA,YAAY,GAAG,IAAI;IACzB,IAAI,CAACC,UAAU,GAAG,EAAE;IACpB,IAAI,CAACF,MAAM,CAACM,OAAO,CAACC,eAAe,IAAI;MACnCC,OAAO,CAACC,GAAG,CAACF,eAAe,CAACG,IAAI,CAACC,QAAQ,CAAC,CAAC,CAAC;MAC5C,MAAMC,qBAAqB,GAAGf,4DAAS,CAACU,eAAe,CAACG,IAAI,CAAC;MAC7D,MAAMG,sBAAsB,GAAGN,eAAe,CAACG,IAAI,CAACC,QAAQ,CAAC,CAAC;MAC9D,IAAI,CAACT,UAAU,CAACY,IAAI,CAAC;QACjBC,IAAI,EAAER,eAAe,CAACQ,IAAI;QAC1BL,IAAI,EAAEH,eAAe,CAACG,IAAI;QAC1BM,OAAO,EAAEJ,qBAAqB,KAAK,OAAO;QAC1Cb,WAAW,EAAEa,qBAAqB,KAAK,OAAO,GACxCjB,+EAA4B,CAACkB,sBAAsB,CAAC,GACpDjB,uEAAoB,CAACiB,sBAAsB;MACrD,CAAC,CAAC;MACF;MACA;MACA;MACA;IACJ,CAAC,CAAC;IACF,IAAI,CAACX,UAAU,CAACe,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;MAC3B,OAAOD,CAAC,CAACnB,WAAW,CAACqB,IAAI,CAACC,MAAM,GAAGF,CAAC,CAACpB,WAAW,CAACqB,IAAI,CAACC,MAAM;IAChE,CAAC,CAAC;IACF,IAAI,CAACnB,UAAU,CAACI,OAAO,CAAEgB,GAAG,IAAK;MAC7B,IAAI,CAACC,cAAc,CAACD,GAAG,CAAC;IAC5B,CAAC,CAAC;EACN;EAEAC,cAAcA,CAACC,KAAK,EAAE;IAClB,IAAI,IAAI,CAACrB,YAAY,CAACsB,GAAG,CAACD,KAAK,CAACT,IAAI,CAAC,EAAE;MACnC,OAAO,IAAI,CAACZ,YAAY,CAACuB,GAAG,CAACF,KAAK,CAACT,IAAI,CAAC;IAC5C;IACA,MAAMY,cAAc,GAAG,EAAE;IACzB,IAAIH,KAAK,CAACzB,WAAW,CAACqB,IAAI,CAACC,MAAM,GAAG,CAAC,EAAE;MACnCG,KAAK,CAACzB,WAAW,CAACqB,IAAI,CAACd,OAAO,CAAEsB,GAAG,IAAK;QACpC,MAAMC,QAAQ,GAAG,IAAI,CAAC3B,UAAU,CAAC4B,IAAI,CAACR,GAAG,IAAIA,GAAG,CAACP,IAAI,KAAKa,GAAG,CAAC;QAC9DD,cAAc,CAACb,IAAI,CAAC,IAAI,CAACS,cAAc,CAACM,QAAQ,CAAC,CAAC;MACtD,CAAC,CAAC;IACN;IACA,IAAIE,QAAQ;IACZ,IAAIP,KAAK,CAACR,OAAO,EAAE;MACfe,QAAQ,GAAG,IAAIP,KAAK,CAACd,IAAI,CAAC,GAAGiB,cAAc,CAAC;IAChD,CAAC,MAAM;MACHI,QAAQ,GAAG,IAAIC,eAAe,CAACR,KAAK,CAACd,IAAI,EAAEiB,cAAc,CAAC;IAC9D;IACA,IAAI,CAACxB,YAAY,CAAC8B,GAAG,CAACT,KAAK,CAACT,IAAI,EAAEgB,QAAQ,CAAC;IAC3C,OAAOA,QAAQ;EACnB;AACJ;AAEA,MAAMC,eAAe,CAAC;EAClBjC,WAAWA,CAACmC,IAAI,EAAEd,IAAI,EAAE;IACpB,IAAI,CAACc,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACd,IAAI,GAAGA,IAAI;IAChBZ,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEyB,IAAI,EAAEd,IAAI,CAAC;EAC9C;EAEAe,IAAIA,CAAA,EAAG;IACH,IAAI,CAACD,IAAI,CAAC,GAAGd,IAAI,CAAC;EACtB;AACJ;AAEA,iEAAetB,UAAU;;;;;;;;;;;;;;AC5EzB,MAAMsC,iBAAiB,GAAG;EACtBC,UAAU,EAAE,CAAC;EACbC,OAAO,EAAE,CAAC;EACVC,SAAS,EAAE,CAAC;EACZC,SAAS,EAAE,CAAC;EACZC,QAAQ,EAAE;AACd,CAAC;AAED,MAAMC,cAAc,CAAC;EACjB3C,WAAWA,CAACgB,IAAI,GAAG,EAAE,EAAEL,IAAI,GAAG,CAAC,CAAC,EAAEiC,SAAS,GAAGP,iBAAiB,CAACG,SAAS,EAAE;IACvE,IAAI,CAACxB,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACL,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACiC,SAAS,GAAGA,SAAS;EAC9B;AACJ;AAAC;AAGD,iEAAeD,cAAc;;;;;;;;;;;;;;ACjB7B,MAAME,MAAM,CAAC;EACT7C,WAAWA,CAAA,EAAG;IACVS,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;EACzB;AACJ;AAEA,iEAAemC,MAAM;;;;;;;;;;;;;;ACNrB,MAAMC,GAAG,CAAC;EACN9C,WAAWA,CAAC+C,MAAM,EAAE;IAChBtC,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEqC,MAAM,CAAC;EACpC;AACJ;AAEA,iEAAeD,GAAG;;;;;;;;;;;;;;ACNlB,MAAME,KAAK,CAAC;EACRhD,WAAWA,CAAC+C,MAAM,EAAEE,GAAG,EAAE;IACrBxC,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAEqC,MAAM,EAAEE,GAAG,CAAC;EACzD;AACJ;AAEA,iEAAeD,KAAK;;;;;;;;;;;;;;ACNpB,MAAME,GAAG,GAAGA,CAAA,KAAM;EACdzC,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;AAC3B,CAAC;AAED,iEAAewC,GAAG;;;;;;;;;;;;;;ACJlB,SAASC,IAAIA,CAACD,GAAG,EAAEH,MAAM,EAAE;EACvBtC,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEwC,GAAG,EAAEH,MAAM,CAAC;AAC9D;AAAC;AAED,iEAAeI,IAAI;;;;;;;;;;;;;;ACJnB,MAAMC,SAAS,GAAG,SAASC,EAAEA,CAACC,MAAM,EAAE;EAClC7C,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAE4C,MAAM,CAAC;AACtD,CAAC;AAED,iEAAeF,SAAS;;;;;;;;;;;;;;ACJxB,MAAME,MAAM,GAAG,SAAAA,CAAUH,IAAI,EAAEI,KAAK,EAAE;EAClC9C,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEyC,IAAI,EAAEI,KAAK,CAAC;AAChE,CAAC;AAED,iEAAeD,MAAM;;;;;;;;;;;;;;ACJrB,MAAME,qBAAqB,SAASC,KAAK,CAAC;EACtCzD,WAAWA,CAAA,EAAG;IACV,IAAI,CAAC0D,OAAO,GAAG,qDAAqD;IACpE,KAAK,CAAC,IAAI,CAACA,OAAO,CAAC;EACvB;AACJ;AAEA,MAAM9D,4BAA4B,GAAG+D,MAAM,IAAI;EAC3C,MAAMC,SAAS,GAAG,aAAa;EAC/B,MAAMC,UAAU,GAAGF,MAAM,CAACG,OAAO,CAACF,SAAS,EAAE,CAAC,CAAC;EAC/C,IAAIC,UAAU,KAAK,CAAC,CAAC,EAAE;IACnB,MAAM,IAAIL,qBAAqB,CAAC,CAAC;EACrC;EACA,MAAMO,mBAAmB,GAAGJ,MAAM,CAACG,OAAO,CAAC,GAAG,EAAED,UAAU,CAAC;EAC3D,MAAMG,oBAAoB,GAAGL,MAAM,CAACG,OAAO,CAAC,GAAG,EAAEC,mBAAmB,CAAC;EACrE,MAAME,OAAO,GAAGN,MAAM,CAACO,KAAK,CAACH,mBAAmB,GAAG,CAAC,EAAEC,oBAAoB,CAAC;EAC3E,MAAM3C,IAAI,GAAG4C,OAAO,CAACE,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACvC,GAAG,IAAIA,GAAG,CAACwC,IAAI,CAAC,CAAC,CAAC,CAACC,MAAM,CAACzC,GAAG,IAAIA,GAAG,KAAK,EAAE,CAAC;EAChF,OAAO;IACH0C,aAAa,EAAEV,UAAU;IACzBxC;EACJ,CAAC;AAEL,CAAC;AAED,iEAAezB,4BAA4B;;;;;;;;;;;;;;ACxB3C,MAAMC,oBAAoB,GAAG2E,OAAO,IAAI;EACpC,MAAMT,mBAAmB,GAAGS,OAAO,CAACV,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC;EACnD,MAAME,oBAAoB,GAAGQ,OAAO,CAACV,OAAO,CAAC,GAAG,EAAEC,mBAAmB,CAAC;EACtE,MAAME,OAAO,GAAGO,OAAO,CAACN,KAAK,CAACH,mBAAmB,GAAG,CAAC,EAAEC,oBAAoB,CAAC;EAC5E,MAAM3C,IAAI,GAAG4C,OAAO,CAACE,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACvC,GAAG,IAAIA,GAAG,CAACwC,IAAI,CAAC,CAAC,CAAC,CAACC,MAAM,CAACzC,GAAG,IAAIA,GAAG,KAAK,EAAE,CAAC;EAChF,OAAO;IACH0C,aAAa,EAAER,mBAAmB;IAClC1C;EACJ,CAAC;AAEL,CAAC;AAED,iEAAexB,oBAAoB;;;;;;;;;;;;;;ACZnC,MAAM4E,sBAAsB,SAAShB,KAAK,CAAC;EACvCzD,WAAWA,CAACW,IAAI,EAAE;IACd,IAAI,CAAC+C,OAAO,GAAI,iCAAgC/C,IAAI,CAACX,WAAW,CAACgB,IAAK,EAAC;IACvE,KAAK,CAAC,IAAI,CAAC0C,OAAO,CAAC;EACvB;AACJ;AAEA,SAAS5D,SAASA,CAACa,IAAI,EAAE;EACrB,IAAI,OAAOA,IAAI,KAAK,UAAU,EAAE;IAC5B,MAAM,IAAI8D,sBAAsB,CAAC9D,IAAI,CAAC;EAC1C;EAAC;EACD,MAAM+D,OAAO,GAAG/D,IAAI,CAACC,QAAQ,CAAC,CAAC;EAC/B,OAAO8D,OAAO,CAACC,UAAU,CAAC,OAAO,CAAC,GAAG,OAAO,GAAG,UAAU;AAC7D;AAEA,iEAAe7E,SAAS;;;;;;UCfxB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;;;;;ACNyC;AACN;AACI;AACU;AACR;AACN;AACE;AACI;AACM;AAE/C,MAAM8E,QAAQ,GAAG,CACb,IAAIjC,0DAAc,CAAC,QAAQ,EAAEE,0DAAM,CAAC,EACpC,IAAIF,0DAAc,CAAC,OAAO,EAAEK,yDAAK,CAAC,EAClC,IAAIL,0DAAc,CAAC,KAAK,EAAEG,uDAAG,CAAC,EAC9B,IAAIH,0DAAc,CAAC,KAAK,EAAEO,uDAAG,CAAC,EAC9B,IAAIP,0DAAc,CAAC,MAAM,EAAEQ,wDAAI,CAAC,EAChC,IAAIR,0DAAc,CAAC,QAAQ,EAAEW,0DAAM,CAAC,EACpC,IAAIX,0DAAc,CAAC,WAAW,EAAES,6DAAS,CAAC,CAC7C;AAED,IAAIrD,sDAAU,CAAC6E,QAAQ,CAAC,CAACtE,IAAI,CAAC,CAAC,C","sources":["webpack://didi-try/./src/AppContext.js","webpack://didi-try/./src/DIObjectConfig.js","webpack://didi-try/./src/modules/Animal.js","webpack://didi-try/./src/modules/Man.js","webpack://didi-try/./src/modules/Woman.js","webpack://didi-try/./src/modules/dot.js","webpack://didi-try/./src/modules/line.js","webpack://didi-try/./src/modules/rectangle.js","webpack://didi-try/./src/modules/square.js","webpack://didi-try/./src/utils/getClassConstructorArgsNames.js","webpack://didi-try/./src/utils/getFunctionArgsNames.js","webpack://didi-try/./src/utils/parseType.js","webpack://didi-try/webpack/bootstrap","webpack://didi-try/webpack/runtime/define property getters","webpack://didi-try/webpack/runtime/hasOwnProperty shorthand","webpack://didi-try/webpack/runtime/make namespace object","webpack://didi-try/./src/index.js"],"sourcesContent":["import getClassConstructorArgsNames from \"./utils/getClassConstructorArgsNames\";\nimport getFunctionArgsNames from \"./utils/getFunctionArgsNames\";\nimport parseType from \"./utils/parseType\";\n\nclass AppContext {\n    constructor(config = {}) {\n        this.config = config;\n    }\n\n    #contextReady = false;\n    allClasses = [];\n    sessionScope = new Map();\n\n    init() {\n        if (this.#contextReady) return;\n        this.#contextReady = true;\n        this.allClasses = [];\n        this.config.forEach(containerObject => {\n            console.log(containerObject.type.toString())\n            const typeOfContainerObject = parseType(containerObject.type);\n            const containerObjectTypeStr = containerObject.type.toString();\n            this.allClasses.push({\n                name: containerObject.name,\n                type: containerObject.type,\n                isClass: typeOfContainerObject === 'class',\n                constructor: typeOfContainerObject === 'class'\n                    ? getClassConstructorArgsNames(containerObjectTypeStr)\n                    : getFunctionArgsNames(containerObjectTypeStr),\n            });\n            // ToDo Все объекты с наименованиями объявленными в аргументах containerObject находятся в контейнере\n            // ToDo Отсутствие циклических зависимостей\n            // ToDo Правила жизненных циклов\n            // Построение дерева зависимостей\n        });\n        this.allClasses.sort((a, b) => {\n            return a.constructor.args.length - b.constructor.args.length;\n        });\n        this.allClasses.forEach((cls) => {\n            this.createInstance(cls);\n        });\n    }\n\n    createInstance(clazz) {\n        if (this.sessionScope.has(clazz.name)) {\n            return this.sessionScope.get(clazz.name);\n        }\n        const argumentValues = [];\n        if (clazz.constructor.args.length > 0) {\n            clazz.constructor.args.forEach((arg) => {\n                const argClazz = this.allClasses.find(cls => cls.name === arg);\n                argumentValues.push(this.createInstance(argClazz));\n            })\n        }\n        let instance;\n        if (clazz.isClass) {\n            instance = new clazz.type(...argumentValues);\n        } else {\n            instance = new FunctionWrapper(clazz.type, argumentValues);\n        }\n        this.sessionScope.set(clazz.name, instance);\n        return instance;\n    }\n}\n\nclass FunctionWrapper {\n    constructor(func, args) {\n        this.func = func;\n        this.args = args;\n        console.log('Func with args ', func, args);\n    }\n\n    call() {\n        this.func(...args);\n    }\n}\n\nexport default AppContext;","const DIObjectLifecycle = {\n    Persistent: 0,\n    Session: 1,\n    Singleton: 2,\n    Prototype: 3,\n    Demanded: 4,\n};\n\nclass DIObjectConfig {\n    constructor(name = '', type = {}, lifecycle = DIObjectLifecycle.Singleton) {\n        this.name = name;\n        this.type = type;\n        this.lifecycle = lifecycle;\n    }\n};\n\n\nexport default DIObjectConfig;\n","class Animal {\n    constructor() {\n        console.log('animal');\n    }\n}\n\nexport default Animal;","class Man {\n    constructor(animal) {\n        console.log('man with ', animal);\n    }\n}\n\nexport default Man;\n","class Woman {\n    constructor(animal, man) {\n        console.log('woman with animal and man', animal, man);\n    }\n}\n\nexport default Woman;\n","const dot = () => {\n    console.log('Func dot');\n};\n\nexport default dot;\n","function line(dot, animal) {\n    console.log('Func line with dot and animal ', dot, animal);\n};\n\nexport default line;\n","const rectangle = function Re(square) {\n    console.log('Func rectangle with square ', square);\n};\n\nexport default rectangle;\n","const square = function (line, woman) {\n    console.log('Func square with line and woman ', line, woman)\n};\n\nexport default square;\n","class HasNoConstructorError extends Error {\n    constructor() {\n        this.message = 'DI object has no one constructor. Need one or more.';\n        super(this.message);\n    }\n}\n\nconst getClassConstructorArgsNames = clsStr => {\n    const separator = 'constructor';\n    const startIndex = clsStr.indexOf(separator, 0);\n    if (startIndex === -1) {\n        throw new HasNoConstructorError();\n    }\n    const openBraceStartIndex = clsStr.indexOf('(', startIndex);\n    const closeBraceStartIndex = clsStr.indexOf(')', openBraceStartIndex);\n    const argsStr = clsStr.slice(openBraceStartIndex + 1, closeBraceStartIndex);\n    const args = argsStr.split(',').map(arg => arg.trim()).filter(arg => arg !== '');\n    return {\n        startPosition: startIndex,\n        args,\n    };\n\n}\n\nexport default getClassConstructorArgsNames;","const getFunctionArgsNames = funcStr => {\n    const openBraceStartIndex = funcStr.indexOf('(', 0);\n    const closeBraceStartIndex = funcStr.indexOf(')', openBraceStartIndex);\n    const argsStr = funcStr.slice(openBraceStartIndex + 1, closeBraceStartIndex);\n    const args = argsStr.split(',').map(arg => arg.trim()).filter(arg => arg !== '');\n    return {\n        startPosition: openBraceStartIndex,\n        args,\n    };\n\n}\n\nexport default getFunctionArgsNames;","class NotAllowedDIObjectType extends Error {\n    constructor(type) {\n        this.message = `Not allowed DI object type of ${type.constructor.name}`;\n        super(this.message);\n    }\n}\n\nfunction parseType(type) {\n    if (typeof type !== 'function') {\n        throw new NotAllowedDIObjectType(type);\n    };\n    const typeStr = type.toString();\n    return typeStr.startsWith('class') ? 'class' : 'function';\n}\n\nexport default parseType;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import Animal from './modules/Animal.js';\nimport Man from './modules/Man.js';\nimport Woman from './modules/Woman.js';\nimport DIObjectConfig from './DIObjectConfig.js';\nimport AppContext from './AppContext.js';\nimport dot from './modules/dot.js';\nimport line from './modules/line.js';\nimport square from './modules/square.js';\nimport rectangle from './modules/rectangle.js';\n\nconst DIConfig = [\n    new DIObjectConfig('animal', Animal),\n    new DIObjectConfig('woman', Woman),\n    new DIObjectConfig('man', Man),\n    new DIObjectConfig('dot', dot),\n    new DIObjectConfig('line', line),\n    new DIObjectConfig('square', square),\n    new DIObjectConfig('rectangle', rectangle),\n];\n\nnew AppContext(DIConfig).init();\n"],"names":["getClassConstructorArgsNames","getFunctionArgsNames","parseType","AppContext","constructor","config","contextReady","allClasses","sessionScope","Map","init","forEach","containerObject","console","log","type","toString","typeOfContainerObject","containerObjectTypeStr","push","name","isClass","sort","a","b","args","length","cls","createInstance","clazz","has","get","argumentValues","arg","argClazz","find","instance","FunctionWrapper","set","func","call","DIObjectLifecycle","Persistent","Session","Singleton","Prototype","Demanded","DIObjectConfig","lifecycle","Animal","Man","animal","Woman","man","dot","line","rectangle","Re","square","woman","HasNoConstructorError","Error","message","clsStr","separator","startIndex","indexOf","openBraceStartIndex","closeBraceStartIndex","argsStr","slice","split","map","trim","filter","startPosition","funcStr","NotAllowedDIObjectType","typeStr","startsWith","DIConfig"],"sourceRoot":""}